import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,b as n,o as t}from"./app-WR0bez8k.js";const l={};function e(h,s){return t(),a("div",null,[...s[0]||(s[0]=[n(`<h1 id="ã€pythonã€‘ã€flaskã€‘å•å…ƒæµ‹è¯•åº”è¯¥æ€ä¹ˆå†™" tabindex="-1"><a class="header-anchor" href="#ã€pythonã€‘ã€flaskã€‘å•å…ƒæµ‹è¯•åº”è¯¥æ€ä¹ˆå†™"><span>ã€Pythonã€‘ã€Flaskã€‘å•å…ƒæµ‹è¯•åº”è¯¥æ€ä¹ˆå†™</span></a></h1><h2 id="flaskåº”ç”¨å•å…ƒæµ‹è¯•å®ç°å®Œæ•´æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#flaskåº”ç”¨å•å…ƒæµ‹è¯•å®ç°å®Œæ•´æ­¥éª¤"><span>Flaskåº”ç”¨å•å…ƒæµ‹è¯•å®ç°å®Œæ•´æ­¥éª¤</span></a></h2><h2 id="ç¯å¢ƒå‡†å¤‡å’Œé¡¹ç›®ç»“æ„" tabindex="-1"><a class="header-anchor" href="#ç¯å¢ƒå‡†å¤‡å’Œé¡¹ç›®ç»“æ„"><span>ç¯å¢ƒå‡†å¤‡å’Œé¡¹ç›®ç»“æ„</span></a></h2><h3 id="_1-å®‰è£…æµ‹è¯•ä¾èµ–" tabindex="-1"><a class="header-anchor" href="#_1-å®‰è£…æµ‹è¯•ä¾èµ–"><span>1. å®‰è£…æµ‹è¯•ä¾èµ–</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pytest</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pytest-flask</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pytest-cov</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> factory-boy</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> faker</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-åˆ›å»ºé¡¹ç›®ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_2-åˆ›å»ºé¡¹ç›®ç»“æ„"><span>2. åˆ›å»ºé¡¹ç›®ç»“æ„</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>my_flask_app/</span></span>
<span class="line"><span>â”œâ”€â”€ app/</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ __init__.py           # åº”ç”¨å·¥å‚å‡½æ•°</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ config.py             # é…ç½®æ–‡ä»¶</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ models/</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ __init__.py</span></span>
<span class="line"><span>â”‚   â”‚   â””â”€â”€ user.py           # ç”¨æˆ·æ¨¡å‹</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ routes/</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ __init__.py</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ auth.py           # è®¤è¯è·¯ç”±</span></span>
<span class="line"><span>â”‚   â”‚   â””â”€â”€ api.py            # APIè·¯ç”±</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ services/</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ __init__.py</span></span>
<span class="line"><span>â”‚   â”‚   â””â”€â”€ user_service.py   # ä¸šåŠ¡é€»è¾‘</span></span>
<span class="line"><span>â”‚   â””â”€â”€ utils/</span></span>
<span class="line"><span>â”‚       â”œâ”€â”€ __init__.py</span></span>
<span class="line"><span>â”‚       â””â”€â”€ helpers.py        # å·¥å…·å‡½æ•°</span></span>
<span class="line"><span>â”œâ”€â”€ tests/</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ __init__.py</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ conftest.py           # æµ‹è¯•é…ç½®</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ factories.py          # æµ‹è¯•æ•°æ®å·¥å‚</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ test_models.py        # æ¨¡å‹æµ‹è¯•</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ test_routes.py        # è·¯ç”±æµ‹è¯•</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ test_services.py      # æœåŠ¡æµ‹è¯•</span></span>
<span class="line"><span>â”‚   â””â”€â”€ test_utils.py         # å·¥å…·å‡½æ•°æµ‹è¯•</span></span>
<span class="line"><span>â”œâ”€â”€ pytest.ini               # pytesté…ç½®</span></span>
<span class="line"><span>â””â”€â”€ requirements.txt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="step-1-å®‰è£…ä¾èµ–" tabindex="-1"><a class="header-anchor" href="#step-1-å®‰è£…ä¾èµ–"><span>Step 1: å®‰è£…ä¾èµ–</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pytest</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pytest-flask</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pytest-cov</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="åº“åŠŸèƒ½è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#åº“åŠŸèƒ½è¯´æ˜"><span>åº“åŠŸèƒ½è¯´æ˜</span></a></h3><ul><li><strong>pytest</strong>: æµ‹è¯•æ¡†æ¶ï¼Œæä¾›æµ‹è¯•å‘ç°ã€è¿è¡Œã€æ–­è¨€åŠŸèƒ½</li><li><strong>pytest-flask</strong>: Flaskä¸“ç”¨æ’ä»¶ï¼Œæä¾›Flaskåº”ç”¨æµ‹è¯•æ”¯æŒ</li><li><strong>pytest-cov</strong>: ä»£ç è¦†ç›–ç‡æ’ä»¶ï¼Œç»Ÿè®¡æµ‹è¯•è¦†ç›–çš„ä»£ç æ¯”ä¾‹</li></ul><h2 id="step-2-åˆ›å»ºæµ‹è¯•é…ç½®æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#step-2-åˆ›å»ºæµ‹è¯•é…ç½®æ–‡ä»¶"><span>Step 2: åˆ›å»ºæµ‹è¯•é…ç½®æ–‡ä»¶</span></a></h2><p><strong><a href="http://conftest.py" target="_blank" rel="noopener noreferrer">conftest.py</a></strong> - pytestçš„å…¨å±€é…ç½®æ–‡ä»¶</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> pytest</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> your_app </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> create_app, db</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">@pytest</span><span style="--shiki-light:#4078F2;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">fixture</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # è£…é¥°å™¨ï¼šæ ‡è®°è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å¤¹å…·ï¼Œå¯ä»¥è¢«æµ‹è¯•å‡½æ•°æ³¨å…¥</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # åˆ›å»ºæµ‹è¯•ç”¨çš„Flaskåº”ç”¨ï¼Œä½¿ç”¨å†…å­˜æ•°æ®åº“</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    app </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> create_app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">({</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;TESTING&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">True</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;SQLALCHEMY_DATABASE_URI&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;sqlite:///:memory:&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">})</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    with</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">app_context</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Flaskåº”ç”¨ä¸Šä¸‹æ–‡ï¼Œè®©æ•°æ®åº“æ“ä½œç”Ÿæ•ˆ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        db.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">create_all</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()      </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># åˆ›å»ºæ‰€æœ‰è¡¨</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        yield</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> app            </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è¿”å›appç»™æµ‹è¯•å‡½æ•°ä½¿ç”¨</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        db.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">drop_all</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()        </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æµ‹è¯•å®Œæˆåæ¸…ç†æ•°æ®åº“</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">@pytest</span><span style="--shiki-light:#4078F2;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">fixture</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> client</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ä¾èµ–äºapp fixtureï¼Œpytestä¼šè‡ªåŠ¨æ³¨å…¥</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">test_client</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è¿”å›Flaskæµ‹è¯•å®¢æˆ·ç«¯ï¼Œç”¨äºæ¨¡æ‹ŸHTTPè¯·æ±‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å…³é”®æ¦‚å¿µè¯´æ˜" tabindex="-1"><a class="header-anchor" href="#å…³é”®æ¦‚å¿µè¯´æ˜"><span>å…³é”®æ¦‚å¿µè¯´æ˜</span></a></h3><ul><li><strong>@pytest.fixture</strong>: åˆ›å»ºå¯é‡ç”¨çš„æµ‹è¯•èµ„æºï¼ˆæ•°æ®ã€å¯¹è±¡ç­‰ï¼‰</li><li><strong>yield</strong>: ç±»ä¼¼returnï¼Œä½†æµ‹è¯•å®Œæˆåä¼šç»§ç»­æ‰§è¡Œyieldåé¢çš„æ¸…ç†ä»£ç </li><li><strong>app_context()</strong>: Flaskåº”ç”¨ä¸Šä¸‹æ–‡ï¼Œç¡®ä¿æ•°æ®åº“ç­‰ç»„ä»¶æ­£å¸¸å·¥ä½œ</li><li><strong>test_client()</strong>: Flaskæä¾›çš„æµ‹è¯•å®¢æˆ·ç«¯ï¼Œå¯ä»¥å‘é€æ¨¡æ‹Ÿçš„HTTPè¯·æ±‚</li></ul><h2 id="step-3-ç¼–å†™æµ‹è¯•æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#step-3-ç¼–å†™æµ‹è¯•æ–‡ä»¶"><span>Step 3: ç¼–å†™æµ‹è¯•æ–‡ä»¶</span></a></h2><p><strong>test_models.py</strong> - æ¨¡å‹æµ‹è¯•</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test_user_creation</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å‡½æ•°åä»¥test_å¼€å¤´ï¼Œpytestè‡ªåŠ¨è¯†åˆ«</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    with</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">app_context</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():   </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># åœ¨Flaskåº”ç”¨ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        user </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> User</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">username</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;test&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">email</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;test@example.com&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        user.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">set_password</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;password&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        db.session.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">add</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(user)    </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ·»åŠ åˆ°æ•°æ®åº“ä¼šè¯</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        db.session.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">commit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()     </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æäº¤äº‹åŠ¡</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        assert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user.id </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">is</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> not</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> None</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # assertæ–­è¨€ï¼šéªŒè¯æ¡ä»¶ä¸ºçœŸ</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        assert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">check_password</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;password&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># éªŒè¯å¯†ç å“ˆå¸ŒåŠŸèƒ½</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>test_routes.py</strong> - è·¯ç”±æµ‹è¯•</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test_register_route</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">client</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># clientå‚æ•°ä¼šè‡ªåŠ¨æ³¨å…¥æµ‹è¯•å®¢æˆ·ç«¯</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    response </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> client.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">post</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;/auth/register&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">json</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å‘é€POSTè¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &#39;username&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;newuser&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &#39;email&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;new@example.com&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &#39;password&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;password123&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    })</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    assert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> response.status_code </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 201</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # éªŒè¯HTTPçŠ¶æ€ç </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    assert</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;user&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> response.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get_json</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># éªŒè¯å“åº”JSONå†…å®¹</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>test_services.py</strong> - ä¸šåŠ¡é€»è¾‘æµ‹è¯•</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test_create_user_service</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    with</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">app_context</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        user </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> UserService.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">create_user</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;test&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;test@example.com&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;password&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        assert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user.username </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;test&#39;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # éªŒè¯è¿”å›çš„ç”¨æˆ·å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        assert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> User.query.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">count</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # éªŒè¯æ•°æ®åº“ä¸­ç¡®å®åˆ›å»ºäº†ç”¨æˆ·</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æµ‹è¯•å‡½æ•°è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#æµ‹è¯•å‡½æ•°è¯´æ˜"><span>æµ‹è¯•å‡½æ•°è¯´æ˜</span></a></h3><ul><li><strong>å‡½æ•°å‘½å</strong>: å¿…é¡»ä»¥<code>test_</code>å¼€å¤´ï¼Œpytestæ‰èƒ½è‡ªåŠ¨å‘ç°</li><li><strong>å‚æ•°æ³¨å…¥</strong>: å‡½æ•°å‚æ•°åå¯¹åº”fixtureåï¼Œpytestè‡ªåŠ¨æ³¨å…¥</li><li><strong>assertæ–­è¨€</strong>: Pythonå†…ç½®ï¼Œç”¨äºéªŒè¯æ¡ä»¶æ˜¯å¦ä¸ºçœŸ</li><li><strong>with app.app_context()</strong>: æ•°æ®åº“æ“ä½œå¿…é¡»åœ¨åº”ç”¨ä¸Šä¸‹æ–‡ä¸­è¿›è¡Œ</li></ul><h2 id="step-4-è¿è¡Œæµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#step-4-è¿è¡Œæµ‹è¯•"><span>Step 4: è¿è¡Œæµ‹è¯•</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pytest</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    # è¿è¡Œæ‰€æœ‰æµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pytest</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # è¯¦ç»†è¾“å‡º (verbose)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pytest</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --cov=your_app</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # æ˜¾ç¤ºè¦†ç›–ç‡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pytest</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -k</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;test_user&quot;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # åªè¿è¡Œåç§°åŒ…å«&quot;test_user&quot;çš„æµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pytest</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tests/test_models.py::test_user_creation</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # è¿è¡Œç‰¹å®šæµ‹è¯•</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å‘½ä»¤å‚æ•°è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#å‘½ä»¤å‚æ•°è¯´æ˜"><span>å‘½ä»¤å‚æ•°è¯´æ˜</span></a></h3><ul><li><strong>v</strong>: verboseï¼Œæ˜¾ç¤ºæ¯ä¸ªæµ‹è¯•çš„è¯¦ç»†ä¿¡æ¯</li><li><strong>-cov</strong>: coverageï¼Œæ˜¾ç¤ºä»£ç è¦†ç›–ç‡ç»Ÿè®¡</li><li><strong>k</strong>: keywordï¼Œæ ¹æ®å…³é”®å­—è¿‡æ»¤æµ‹è¯•</li><li><strong>::</strong>: ç”¨äºæŒ‡å®šå…·ä½“çš„æµ‹è¯•æ–‡ä»¶å’Œå‡½æ•°</li></ul><h2 id="æ ¸å¿ƒåŸåˆ™" tabindex="-1"><a class="header-anchor" href="#æ ¸å¿ƒåŸåˆ™"><span>æ ¸å¿ƒåŸåˆ™</span></a></h2><ol><li><strong>ä¸€ä¸ªæµ‹è¯•åªæµ‹ä¸€ä¸ªåŠŸèƒ½</strong></li><li><strong>ä½¿ç”¨å†…å­˜æ•°æ®åº“é¿å…çœŸå®æ•°æ®åº“æ“ä½œ</strong></li><li><strong>é€šè¿‡fixtureæä¾›æµ‹è¯•æ•°æ®</strong></li><li><strong>Mockå¤–éƒ¨ä¾èµ–ï¼Œä¿ç•™ä¸šåŠ¡é€»è¾‘</strong></li></ol><h2 id="mockç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#mockç¤ºä¾‹"><span>Mockç¤ºä¾‹</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> unittest.mock </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> patch</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test_with_mock</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    with</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">app_context</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # @patchè£…é¥°å™¨ï¼šæ›¿æ¢æŒ‡å®šçš„å‡½æ•°/å¯¹è±¡ä¸ºMockå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        with</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> patch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;your_app.services.send_email&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> mock_email:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            mock_email.return_value </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> True</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # è®¾ç½®Mockçš„è¿”å›å€¼</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # æµ‹è¯•ä½ çš„ä¸šåŠ¡é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            result </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> some_function_that_sends_email</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # éªŒè¯é‚®ä»¶å‘é€è¢«è°ƒç”¨äº†ä¸€æ¬¡</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            mock_email.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">assert_called_once</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test_exception_handling</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    with</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">app_context</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # è®©MockæŠ›å‡ºå¼‚å¸¸ï¼Œæµ‹è¯•é”™è¯¯å¤„ç†</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        with</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> patch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;your_app.dao.create_user&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> mock_create:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            mock_create.side_effect </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;"> Exception</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;æ•°æ®åº“é”™è¯¯&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # ä½¿ç”¨pytest.raiseséªŒè¯å¼‚å¸¸</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            with</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> pytest.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">raises</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">Exception</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">match</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;æ•°æ®åº“é”™è¯¯&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                UserService.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">create_user</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;test&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;test@example.com&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;password&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="mockç›¸å…³è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#mockç›¸å…³è¯´æ˜"><span>Mockç›¸å…³è¯´æ˜</span></a></h3><ul><li><strong>@patch</strong>: unittest.mockæ¨¡å—çš„è£…é¥°å™¨ï¼Œç”¨äºæ›¿æ¢å‡½æ•°/å¯¹è±¡</li><li><strong>Mockå¯¹è±¡</strong>: æ¨¡æ‹Ÿçš„å‡å¯¹è±¡ï¼Œå¯ä»¥è®¾ç½®è¿”å›å€¼å’Œè¡Œä¸º</li><li><strong>return_value</strong>: è®¾ç½®Mockå¯¹è±¡è¢«è°ƒç”¨æ—¶çš„è¿”å›å€¼</li><li><strong>side_effect</strong>: è®¾ç½®Mockå¯¹è±¡è¢«è°ƒç”¨æ—¶çš„å‰¯ä½œç”¨ï¼ˆå¦‚æŠ›å¼‚å¸¸ï¼‰</li><li><strong>assert_called_once()</strong>: éªŒè¯Mockå¯¹è±¡è¢«è°ƒç”¨äº†ä¸€æ¬¡</li><li><strong>pytest.raises</strong>: pytestæä¾›çš„å¼‚å¸¸æ–­è¨€å·¥å…·</li></ul><h2 id="å¸¸è§æµ‹è¯•åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#å¸¸è§æµ‹è¯•åœºæ™¯"><span>å¸¸è§æµ‹è¯•åœºæ™¯</span></a></h2><ul><li><strong>æ­£å¸¸æµç¨‹</strong>: æµ‹è¯•åŠŸèƒ½æ­£ç¡®æ‰§è¡Œ</li><li><strong>å¼‚å¸¸å¤„ç†</strong>: æµ‹è¯•é”™è¯¯æƒ…å†µçš„å¤„ç†</li><li><strong>è¾¹ç•Œæ¡ä»¶</strong>: æµ‹è¯•ç©ºå€¼ã€æå€¼ç­‰æƒ…å†µ</li><li><strong>ä¸šåŠ¡è§„åˆ™</strong>: æµ‹è¯•ä¸šåŠ¡é€»è¾‘çº¦æŸ</li></ul><p>ğŸ“ <a href="https://www.notion.so/kepler452b/Python-Flask-Unitest-Mock-25c1866cd30f80789301d0c1b542b5c1?v=25c1866cd30f80bb8ba8000cdd7b4a9d&amp;source=copy_link" target="_blank" rel="noopener noreferrer">åœ¨notionä¸Šç®¡ç†æ­¤é¡µ</a></p>`,38)])])}const r=i(l,[["render",e]]),d=JSON.parse(`{"path":"/zh/development/backend/how-to-write-unitest-python.html","title":"ã€Pythonã€‘ã€Flaskã€‘å•å…ƒæµ‹è¯•åº”è¯¥æ€ä¹ˆå†™","lang":"zh-CN","frontmatter":{"icon":"pen-to-square","date":"2025-08-27T00:00:00.000Z","category":["åç«¯"],"tag":["Python","unitest"],"description":"ã€Pythonã€‘ã€Flaskã€‘å•å…ƒæµ‹è¯•åº”è¯¥æ€ä¹ˆå†™ Flaskåº”ç”¨å•å…ƒæµ‹è¯•å®ç°å®Œæ•´æ­¥éª¤ ç¯å¢ƒå‡†å¤‡å’Œé¡¹ç›®ç»“æ„ 1. å®‰è£…æµ‹è¯•ä¾èµ– 2. åˆ›å»ºé¡¹ç›®ç»“æ„ Step 1: å®‰è£…ä¾èµ– åº“åŠŸèƒ½è¯´æ˜ pytest: æµ‹è¯•æ¡†æ¶ï¼Œæä¾›æµ‹è¯•å‘ç°ã€è¿è¡Œã€æ–­è¨€åŠŸèƒ½ pytest-flask: Flaskä¸“ç”¨æ’ä»¶ï¼Œæä¾›Flaskåº”ç”¨æµ‹è¯•æ”¯æŒ pytest-cov: ä»£ç è¦†ç›–ç‡æ’ä»¶...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"ã€Pythonã€‘ã€Flaskã€‘å•å…ƒæµ‹è¯•åº”è¯¥æ€ä¹ˆå†™\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2025-08-27T00:00:00.000Z\\",\\"dateModified\\":\\"2025-08-27T07:50:09.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Kepler452Byte\\",\\"url\\":\\"https://kepler452byte.github.io\\"}]}"],["meta",{"property":"og:url","content":"https://kepler452byte.github.io/zh/development/backend/how-to-write-unitest-python.html"}],["meta",{"property":"og:site_name","content":"Kepler452Byte's Blog"}],["meta",{"property":"og:title","content":"ã€Pythonã€‘ã€Flaskã€‘å•å…ƒæµ‹è¯•åº”è¯¥æ€ä¹ˆå†™"}],["meta",{"property":"og:description","content":"ã€Pythonã€‘ã€Flaskã€‘å•å…ƒæµ‹è¯•åº”è¯¥æ€ä¹ˆå†™ Flaskåº”ç”¨å•å…ƒæµ‹è¯•å®ç°å®Œæ•´æ­¥éª¤ ç¯å¢ƒå‡†å¤‡å’Œé¡¹ç›®ç»“æ„ 1. å®‰è£…æµ‹è¯•ä¾èµ– 2. åˆ›å»ºé¡¹ç›®ç»“æ„ Step 1: å®‰è£…ä¾èµ– åº“åŠŸèƒ½è¯´æ˜ pytest: æµ‹è¯•æ¡†æ¶ï¼Œæä¾›æµ‹è¯•å‘ç°ã€è¿è¡Œã€æ–­è¨€åŠŸèƒ½ pytest-flask: Flaskä¸“ç”¨æ’ä»¶ï¼Œæä¾›Flaskåº”ç”¨æµ‹è¯•æ”¯æŒ pytest-cov: ä»£ç è¦†ç›–ç‡æ’ä»¶..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-08-27T07:50:09.000Z"}],["meta",{"property":"article:tag","content":"unitest"}],["meta",{"property":"article:tag","content":"Python"}],["meta",{"property":"article:published_time","content":"2025-08-27T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-08-27T07:50:09.000Z"}]]},"git":{"createdTime":1756281009000,"updatedTime":1756281009000,"contributors":[{"name":"sx-yuanhong.shao","username":"","email":"sx-yuanhong.shao@clickzetta.com","commits":1}]},"readingTime":{"minutes":3.94,"words":1182},"filePathRelative":"zh/development/backend/how-to-write-unitest-python.md","excerpt":"\\n<h2>Flaskåº”ç”¨å•å…ƒæµ‹è¯•å®ç°å®Œæ•´æ­¥éª¤</h2>\\n<h2>ç¯å¢ƒå‡†å¤‡å’Œé¡¹ç›®ç»“æ„</h2>\\n<h3>1. å®‰è£…æµ‹è¯•ä¾èµ–</h3>\\n<div class=\\"language-bash line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"bash\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code class=\\"language-bash\\"><span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">pip</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> install</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> pytest</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> pytest-flask</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> pytest-cov</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> factory-boy</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> faker</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div></div></div>","autoDesc":true}`);export{r as comp,d as data};
